
---------------User Setting--------------------

CREATE TABLE CountryTable (
    CountryID INT IDENTITY(1,1),
    CountryTitle NVARCHAR(100) NOT NULL,
    CONSTRAINT PK_CountryTable_CountryID PRIMARY KEY (CountryID)
);
CREATE TABLE CityTable (
    CityId INT IDENTITY(1,1),
    CountryID INT NOT NULL,
    CityName NVARCHAR(100) NOT NULL,
    CONSTRAINT PK_CityTable_CityId PRIMARY KEY (CityId),
    CONSTRAINT FK_CityTable_CountryTable 
        FOREIGN KEY (CountryID) REFERENCES CountryTable(CountryID)
);
CREATE TABLE GenderTable (
    GenderId INT IDENTITY(1,1),
    GenderType NVARCHAR(50) NOT NULL,
    CONSTRAINT PK_GenderTable_GenderId PRIMARY KEY (GenderId)
);
CREATE TABLE UserStatusTable (
    UserStatusID INT IDENTITY(1,1),
    UserStatus NVARCHAR(50) NOT NULL,
    CONSTRAINT PK_UserStatusTable_UserStatusID PRIMARY KEY (UserStatusID)
);
CREATE TABLE UserTypeTable (
    UserTypeId INT IDENTITY(1,1),
    UserType NVARCHAR(50) NOT NULL,
    CONSTRAINT PK_UserTypeTable_UserTypeId PRIMARY KEY (UserTypeId)
);
CREATE TABLE AddressTypeTable (
    AddressTypeID INT IDENTITY(1,1),
    AddressType NVARCHAR(50) NOT NULL,
    CONSTRAINT PK_AddressTypeTable_AddressTypeID PRIMARY KEY (AddressTypeID)
);
CREATE TABLE StatusTable (
    StatusID INT IDENTITY(1,1),
    StatusTitle NVARCHAR(50) NOT NULL,
    CONSTRAINT PK_StatusTable_StatusID PRIMARY KEY (StatusID)
);
CREATE TABLE UserTable (
    UserId INT IDENTITY(1,1),
    UserTypeId INT NOT NULL,
    UserName NVARCHAR(100) NOT NULL,
    [Password] NVARCHAR(200) NOT NULL,
    EmailAddress NVARCHAR(200) NOT NULL,
    FirstName NVARCHAR(100) NOT NULL,
    LastName NVARCHAR(100) NOT NULL,
    ContactNo NVARCHAR(50) NULL,
    GenderId INT NOT NULL,
    UserStatusID INT NOT NULL,

    CONSTRAINT PK_UserTable_UserId PRIMARY KEY (UserId),

    CONSTRAINT FK_UserTable_UserTypeTable
        FOREIGN KEY (UserTypeId) REFERENCES UserTypeTable(UserTypeId),

    CONSTRAINT FK_UserTable_GenderTable
        FOREIGN KEY (GenderId) REFERENCES GenderTable(GenderId),

    CONSTRAINT FK_UserTable_UserStatusTable
        FOREIGN KEY (UserStatusID) REFERENCES UserStatusTable(UserStatusID)
);
CREATE TABLE UserAddressTable (
    UserAddressID INT IDENTITY(1,1),
    UserID INT NOT NULL,
    AddressTypeID INT NOT NULL,
    FullAddress NVARCHAR(500) NOT NULL,
    CityID INT NOT NULL,
    PostalCode NVARCHAR(20) NULL,
    ContactNo NVARCHAR(50) NULL,
    StatusID INT NOT NULL,

    CONSTRAINT PK_UserAddressTable_UserAddressID PRIMARY KEY (UserAddressID),

    CONSTRAINT FK_UserAddressTable_UserTable
        FOREIGN KEY (UserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_UserAddressTable_AddressTypeTable
        FOREIGN KEY (AddressTypeID) REFERENCES AddressTypeTable(AddressTypeID),

    CONSTRAINT FK_UserAddressTable_CityTable
        FOREIGN KEY (CityID) REFERENCES CityTable(CityId),

    CONSTRAINT FK_UserAddressTable_StatusTable
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);

---------------Stock Setting--------------------

/* ===========================
   MAIN CATEGORY
=========================== */

CREATE TABLE MainCategoryTable (
    MainCategoryID INT IDENTITY(1,1) PRIMARY KEY,
    MainCategoryTitle NVARCHAR(250) NOT NULL,
    CreatedByUserID INT NOT NULL,
    CreatedDate DATE NOT NULL,
    CreatedTime TIME(7) NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_MainCategory_User 
        FOREIGN KEY (CreatedByUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_MainCategory_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   SUB CATEGORY
=========================== */

CREATE TABLE SubCategoryTable(
    SubCategoryID INT IDENTITY(1,1) PRIMARY KEY,
    MainCategoryID INT NOT NULL,
    SubCategoryTitle NVARCHAR(350) NOT NULL,
    CreatedByUserID INT NOT NULL,
    CreatedDate DATE NOT NULL,
    CreatedTime TIME NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_SubCategory_MainCategory
        FOREIGN KEY (MainCategoryID) REFERENCES MainCategoryTable(MainCategoryID),

    CONSTRAINT FK_SubCategory_User
        FOREIGN KEY (CreatedByUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_SubCategory_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   UNIT & TAG
=========================== */

CREATE TABLE UnitTable(
    UnitID INT IDENTITY(1,1) PRIMARY KEY,
    UnitTitle NVARCHAR(30) NOT NULL
);

CREATE TABLE TagTable(
    TagID INT IDENTITY(1,1) PRIMARY KEY,
    TagTitle NVARCHAR(150) NOT NULL
);


/* ===========================
   COLOR & BRAND
=========================== */

CREATE TABLE ColorTypeTable (
    ColorTypeID INT IDENTITY(1,1) PRIMARY KEY,
    ColorTitle NVARCHAR(150) NOT NULL,
    ColorCode NVARCHAR(30) NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_Color_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);

CREATE TABLE BrandTable (
    BrandID INT IDENTITY(1,1) PRIMARY KEY,
    BrandTitle NVARCHAR(250) NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_Brand_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   PRODUCT HEADER
=========================== */

CREATE TABLE ProductHeaderTable(
    ProductHeaderID INT IDENTITY(1,1) PRIMARY KEY,
    SubCategoryID INT NOT NULL,
    BrandID INT NOT NULL,
    ProductTitle NVARCHAR(350) NOT NULL,
    ProductInformation NVARCHAR(MAX) NOT NULL,
    SKUCode VARCHAR(20) NOT NULL,
    CreatedByUserID INT NOT NULL,
    UpdatedByUserID INT NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_ProductHeader_SubCategory
        FOREIGN KEY (SubCategoryID) REFERENCES SubCategoryTable(SubCategoryID),

    CONSTRAINT FK_ProductHeader_Brand
        FOREIGN KEY (BrandID) REFERENCES BrandTable(BrandID),

    CONSTRAINT FK_ProductHeader_CreatedUser
        FOREIGN KEY (CreatedByUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_ProductHeader_UpdatedUser
        FOREIGN KEY (UpdatedByUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_ProductHeader_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   SIZE STRUCTURE
=========================== */

CREATE TABLE SizeTypeTable(
    SizeTypeID INT IDENTITY(1,1) PRIMARY KEY,
    SizeType NVARCHAR(50) NOT NULL
);

CREATE TABLE SizeLevelTable(
    SizeLevelID INT IDENTITY(1,1) PRIMARY KEY,
    SizeLevel NVARCHAR(50) NOT NULL
);

CREATE TABLE SizeTypeByLevelTable(
    SizeTypeByLevelID INT IDENTITY(1,1) PRIMARY KEY,
    SizeTypeID INT NOT NULL,
    SizeLevelID INT NOT NULL,
    SizeLevelValue NVARCHAR(50) NOT NULL,
    GenderID INT NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_SizeTypeByLevel_SizeType
        FOREIGN KEY (SizeTypeID) REFERENCES SizeTypeTable(SizeTypeID),

    CONSTRAINT FK_SizeTypeByLevel_SizeLevel
        FOREIGN KEY (SizeLevelID) REFERENCES SizeLevelTable(SizeLevelID),

    CONSTRAINT FK_SizeTypeByLevel_Gender
        FOREIGN KEY (GenderID) REFERENCES GenderTable(GenderId),

    CONSTRAINT FK_SizeTypeByLevel_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   PRODUCT DETAIL (VARIANT / INVENTORY)
=========================== */

CREATE TABLE ProductDetailTable(
    ProductDetailID INT IDENTITY(1,1) PRIMARY KEY,
    ProductHeaderID INT NOT NULL,
    ColorTypeID INT NOT NULL,
    SizeTypeByLevelID INT NOT NULL,
    UnitID INT NOT NULL,
    Quantity INT NOT NULL,
    UnitPrice DECIMAL(18,2) NOT NULL,
    Barcode VARCHAR(50) NOT NULL,
    StatusID INT NOT NULL,
    CreatedByUserID INT NOT NULL,
    UpdatedByUserID INT NOT NULL,

    CONSTRAINT FK_ProductDetail_ProductHeader
        FOREIGN KEY (ProductHeaderID) REFERENCES ProductHeaderTable(ProductHeaderID),

    CONSTRAINT FK_ProductDetail_Color
        FOREIGN KEY (ColorTypeID) REFERENCES ColorTypeTable(ColorTypeID),

    CONSTRAINT FK_ProductDetail_Size
        FOREIGN KEY (SizeTypeByLevelID) REFERENCES SizeTypeByLevelTable(SizeTypeByLevelID),

    CONSTRAINT FK_ProductDetail_Unit
        FOREIGN KEY (UnitID) REFERENCES UnitTable(UnitID),

    CONSTRAINT FK_ProductDetail_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID),

    CONSTRAINT FK_ProductDetail_CreatedUser
        FOREIGN KEY (CreatedByUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_ProductDetail_UpdatedUser
        FOREIGN KEY (UpdatedByUserID) REFERENCES UserTable(UserId)
);


/* ===========================
   PRODUCT FEATURE
=========================== */

CREATE TABLE ProductFeatureTable(
    ProductFeatureID INT IDENTITY(1,1) PRIMARY KEY,
    ProductHeaderID INT NOT NULL,
    ProductFeature NVARCHAR(MAX) NOT NULL,
    CreatedByUserID INT NOT NULL,
    UpdatedByUserID INT NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_ProductFeature_ProductHeader
        FOREIGN KEY (ProductHeaderID) REFERENCES ProductHeaderTable(ProductHeaderID),

    CONSTRAINT FK_ProductFeature_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   PRODUCT TAG (MANY-TO-MANY)
=========================== */

CREATE TABLE ProductTagTable(
    ProductTagID INT IDENTITY(1,1) PRIMARY KEY,
    ProductHeaderID INT NOT NULL,
    TagID INT NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_ProductTag_Product
        FOREIGN KEY (ProductHeaderID) REFERENCES ProductHeaderTable(ProductHeaderID),

    CONSTRAINT FK_ProductTag_Tag
        FOREIGN KEY (TagID) REFERENCES TagTable(TagID),

    CONSTRAINT FK_ProductTag_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);


/* ===========================
   COMPARE & WISHLIST
=========================== */

CREATE TABLE CompareTable(
    CompareID INT IDENTITY(1,1) PRIMARY KEY,
    CompareUserID INT NOT NULL,
    ProductDetailID INT NOT NULL,

    CONSTRAINT FK_Compare_User
        FOREIGN KEY (CompareUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_Compare_ProductDetail
        FOREIGN KEY (ProductDetailID) REFERENCES ProductDetailTable(ProductDetailID)
);

CREATE TABLE WishListTable(
    WishListID INT IDENTITY(1,1) PRIMARY KEY,
    WishListUserID INT NOT NULL,
    ProductHeaderID INT NOT NULL,
    AddDate DATE NOT NULL,

    CONSTRAINT FK_WishList_User
        FOREIGN KEY (WishListUserID) REFERENCES UserTable(UserId),

    CONSTRAINT FK_WishList_Product
        FOREIGN KEY (ProductHeaderID) REFERENCES ProductHeaderTable(ProductHeaderID)
);


/* ===========================
   SEASON & DISCOUNT
=========================== */

CREATE TABLE SeasonTable(
    SeasonID INT IDENTITY(1,1) PRIMARY KEY,
    SeasonTitle NVARCHAR(500) NOT NULL,
    SeasonStartDate DATE NOT NULL,
    SeasonEndDate DATE NOT NULL,
    CreatedByUserID INT NOT NULL,

    CONSTRAINT FK_Season_User
        FOREIGN KEY (CreatedByUserID) REFERENCES UserTable(UserId)
);

CREATE TABLE SeasonDiscountTable(
    SeasonDiscountID INT IDENTITY(1,1) PRIMARY KEY,
    SeasonID INT NOT NULL,
    ProductHeaderID INT NOT NULL,
    DiscountPercent INT NOT NULL,
    StatusID INT NOT NULL,

    CONSTRAINT FK_SeasonDiscount_Season
        FOREIGN KEY (SeasonID) REFERENCES SeasonTable(SeasonID),

    CONSTRAINT FK_SeasonDiscount_Product
        FOREIGN KEY (ProductHeaderID) REFERENCES ProductHeaderTable(ProductHeaderID),

    CONSTRAINT FK_SeasonDiscount_Status
        FOREIGN KEY (StatusID) REFERENCES StatusTable(StatusID)
);
-----------------Order and Payment Setting--------------------

CREATE TABLE CartTable (
    CartID INT IDENTITY(1,1),
	ProductDetailID int not null,
	Quantity int not null,
	DiscountID int not null,
    UniqueNo NVARCHAR(50) NOT NULL,
    CONSTRAINT PK_CartTable_CartID PRIMARY KEY (CartID)
);
CREATE TABLE ShippingFeeTable (
    ShippingFeeID INT IDENTITY(1,1),
	CityID int not null,
	ShippingFee float not null,
	DeliveryTimeinDays int not null,
    SattusID int NOT NULL,
    CONSTRAINT PK_ShippingFeeTable_ShippingFeeID PRIMARY KEY (ShippingFeeID)
);
CREATE TABLE OrderStatusTable (
    OrderStatusID INT IDENTITY(1,1),
	OrderStatusTitle nvarchar(50) not null,
    SattusID int NOT NULL,
    CONSTRAINT PK_OrderStatusTable_OrderStatusID PRIMARY KEY (OrderStatusID)
);
CREATE TABLE PaymentTypeTable (
    PaymentTypeID INT IDENTITY(1,1),
	PaymentType nvarchar(150) not null,  
    CONSTRAINT PK_PaymentTypeTable_PaymentTypeID PRIMARY KEY (PaymentTypeID)
);

CREATE TABLE OrderHeaderTable (
    OrderHeaderID INT IDENTITY(1,1),
	ShippingFeeID int not null,
	UserAddressID int not null,
	TotalCost float not null,
	DiscountAmount float not null,
	TotalPayment float not null,
	OrderDate date not null,
	OrderTime time(7) not null,
	ShippingDate date not null,
	OrderStatusID int not null,
	PaymentTypeID int not null,
	TransactionNo nvarchar(150) not null,  
	TransactionTime time(7) not null,
	PaymentReceiptSanpshot varchar(500) not null,
    CONSTRAINT PK_OrderHeaderTable_OrderHeaderID PRIMARY KEY (OrderHeaderID)
);

	
